<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>User Stock Summary</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; background: #f6f8fa;}
        .container { max-width: 700px; margin: 38px auto; background: #fff3cd; padding: 26px 22px; border-radius: 13px; box-shadow: 0 2px 16px #bb66ff;}
        h2 { color: #2a4687; text-align: center; margin-bottom: 22px;}
        label { font-weight: 600; margin-top: 12px; display: block;}
        select, input[type=text] { width: 100%; padding: 8px; border-radius: 7px; border: 1px solid #c5d1e7; margin-bottom: 14px;}
        .btn { background: #274c97; color: #fff; border: none; border-radius: 7px; padding: 10px 0; width: 100%; font-size: 1.06rem; font-weight: 600; cursor:pointer;}
        table { width: 90%; border-collapse: collapse; margin-top: 28px;}
        th, td { border: 1px solid #c26d01; padding: 7px 11px; text-align: center;}
        th { background: #319fc5; }
    </style>
</head>
<body>
<div class="container">
    <h2>Stock Summary</h2>
    <form method="get" th:action="@{/user/stock-summary}">
        <label for="warehouse">Warehouse</label>
        <select id="warehouse" name="warehouse" required>
            <option value="" th:selected="${warehouse == null or warehouse == ''}">-- Select Warehouse --</option>
            <option th:each="w : ${warehouses}" th:value="${w}" th:text="${w}" th:selected="${w == warehouse}"></option>
        </select>
        <label for="commodity">Commodity</label>
        <select id="commodity" name="commodity" required>
            <option value="" th:selected="${commodity == null or commodity == ''}">-- Select Commodity --</option>
            <option th:each="c : ${commodities}" th:value="${c}" th:text="${c}" th:selected="${c == commodity}"></option>
        </select>
        <button type="submit" class="btn">Show Summary</button>
    </form>

    <div th:if="${summary != null}">
        <table>
            <thead>
            <tr>
                <th>Stockist Name</th>
                <th>Company Purchase (kg)</th>
                <th>Self Storage (kg)</th>
                <th>Withdrawn (kg)</th>
                <th>Net Available Stock (kg)</th>
                <th>Margin Paid (₹)</th>
                <th>Cash Loan (₹)</th>
                <th>Margin Loan (₹)</th>
                <th>Total Loan Due (₹)</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td th:text="${summary.stockistName}"></td>
                <td th:text="${#numbers.formatDecimal(summary.companyPurchase, 0, 'COMMA', 2, 'POINT')}"></td>
                <td th:text="${#numbers.formatDecimal(summary.selfStorage, 0, 'COMMA', 2, 'POINT')}"></td>
                <td th:text="${#numbers.formatDecimal(summary.withdrawn, 0, 'COMMA', 2, 'POINT')}"></td>
                <td th:text="${#numbers.formatDecimal(summary.netAvailableStock, 0, 'COMMA', 2, 'POINT')}"></td>
                <td th:text="${#numbers.formatDecimal(summary.marginPaid, 0, 'COMMA', 2, 'POINT')}"></td>
                <td th:text="${#numbers.formatDecimal(summary.cashLoan, 0, 'COMMA', 2, 'POINT')}"></td>
                <td th:text="${#numbers.formatDecimal(summary.marginLoan, 0, 'COMMA', 2, 'POINT')}"></td>
                <td th:text="${#numbers.formatDecimal(summary.totalLoanDue, 0, 'COMMA', 2, 'POINT')}"></td>
            </tr>
            </tbody>
        </table>
    </div>
    <div th:if="${summary == null}">
        <p style="color:#a65d2b;text-align:center;margin-top:30px;">No summary to display. Please select warehouse and commodity.</p>
    </div>
</div>
</body>
</html>
